* 此文档开放评论, 欢迎反馈&补充
* 作者创作不易, 欢迎前往 [赞助页](https://afdian.net/@mengzonefire) 支持作者
* 本文档不定时更新, 最后更新时间: 21.7.5
# 前言
由于旧版脚本1.6.7版本中的 修复下载 功能 已在21年4月上旬失效(官方封杀), 目前已经没有任何硬性的反和谐*手段, 只能通过以往总结的一些软性手段实现防和谐.

  *和谐 即文件无法下载&分享, 提示 "该文件包含..."

此文档将用于记录已知的度盘和谐机制及解决方法, 可尽量分享给有需要的人.


---


# 已知和谐机制&对策
1. 在线解压导致的文件和谐:
##   机制:

已知在使用度盘的 "在线解压" 功能时, 会记录压缩包中的文件, 若包含已和谐的媒体文件(视频/图片/音频等), 就会和谐压缩包文件. 

*被此机制和谐的文件(仅限压缩文件), 通过 "在线解压" 提取压缩包内的所有文件中, 将至少有1个文件是和谐文件.

##   对策:

通过 "双层压缩"(详见下章) 规避

2. 敏感账号分享导致和谐
##  机制:

文件分享者的账号在达到一定的分享量&举报量后, 可能被标记为敏感账号, 敏感账号使用分享链分享的文件, 在达到一定的访问量(转存&下载, 数值大致为50-100范围)之后, 文件自动被和谐, 但使用秒传分享不受此机制影响(秒传不涉及传统的分享过程).

*此机制未经过实际验证, 仅为分析大量现象后得出的结论, 也无法明确判断账号是否为敏感

##  对策:

不使用分享链接的方式分享文件, 但无法排除&防止其他人使用分享链接分享该文件

*被此机制和谐的压缩文件, 可尝试通过 "在线解压" 提取压缩包内的文件, 大概率可以完整提取所有文件且均未和谐.

3. 手动举报导致的文件和谐
##  机制:

使用分享链接分享文件后, 通过分享链接页面的举报按钮举报, 可能导致文件被和谐

*此机制未经过实际验证, 考虑到度盘的文件数量, 很难认为官方通过人工审查举报的文件, 猜测是举报到一定次数(一个账号只能举报同文件一次), 自动和谐文件

##  对策:

不使用分享链接的方式分享文件, 但无法排除&防止其他人使用分享链接分享该文件

*简单的道理: 不开分享链接就没有举报按钮

*被此机制和谐的压缩文件, 可尝试通过 "在线解压" 提取压缩包内的文件, 大概率可以完整提取所有文件且均未和谐.


---


# 双层压缩
使用任意压缩格式将原压缩包再压缩一次, 经过测试发现可以有效防和谐, 双层压缩的压缩包在线解压后只有内层压缩包会被和谐, 而外层压缩不会被和谐(验证过程见下文).

PS1: 若需要分卷压缩时, 请先单卷压缩一层, 再压分卷, 单层分卷同样是不安全的(虽然不支持在线解压).

PS2: 提供一个一键批量双层压缩的工具(请使用秒传转存):

```plain
E1B64120FB2B055967088D20E611036F#49F0034A2084B04B4D9B8E6B5083C101#11153597#auto_double_7z 批量双层压缩工具v1.0.zip
```
 *使用方法及程序源码: [GitHub ](https://github.com/mengzonefire/auto_double_7z)
双压防和谐的对照验证过程:

1组: 直接上传已和谐的视频文件 -> 文件和谐

2组: 将视频文件压缩为zip(无加密) -> 上传 -> 分享 -> 在线解压 -> 压缩包被和谐

3组: 将2组的zip文件再压缩一次(无加密zip) -> 上传 -> 分享 -> 在线解压 -> 解压出来的内层zip被和谐, 但原压缩包未和谐.

*测试时间2021.6.7, 使用度盘PC客户端测试

综上可知双层压缩(任意压缩格式,甚至无加密的zip)可以有效防止在线解压导致的文件和谐, 猜测原理为在线解压只扫描压缩包内的媒体文件而不扫描其他文件(例如压缩文件).

测试用文件(内含已和谐的视频文件): 

```plain
9cc50eb5bfa89c2afe7530147da543d0#1f16080c649112dc87a3ccc26ae59476#368758780#测试.zip
```

